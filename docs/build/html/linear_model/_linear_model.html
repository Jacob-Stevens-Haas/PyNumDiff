

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>_linear_model &mdash; PyNumDiff 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="smooth_finite_difference" href="../smooth_finite_difference.html" />
    <link rel="prev" title="linear_model" href="../linear_model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PyNumDiff
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../code.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../finite_difference.html">finite_difference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kalman_smooth.html">kalman_smooth</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../linear_model.html">linear_model</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">_linear_model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../smooth_finite_difference.html">smooth_finite_difference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../total_variation_regularization.html">total_variation_regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimize.html">optimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyNumDiff</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../code.html">API documentation</a> &raquo;</li>
        
          <li><a href="../linear_model.html">linear_model</a> &raquo;</li>
        
      <li>_linear_model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/linear_model/_linear_model.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pynumdiff.linear_model._linear_model">
<span id="linear-model"></span><h1>_linear_model<a class="headerlink" href="#module-pynumdiff.linear_model._linear_model" title="Permalink to this headline">¶</a></h1>
<p>This module implements some common finite difference schemes</p>
<dl class="py function">
<dt id="pynumdiff.linear_model._linear_model.chebydiff">
<code class="sig-prename descclassname"><span class="pre">pynumdiff.linear_model._linear_model.</span></code><code class="sig-name descname"><span class="pre">chebydiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pynumdiff.linear_model._linear_model.chebydiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Slide a smoothing derivative function across a times eries with specified window size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em><em> (</em><em>float</em><em>)</em>) – array of time series to differentiate</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step size</p></li>
<li><p><strong>params</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – <p>a list of 2 elements:</p>
<ul>
<li><p>N: order of the polynomial</p></li>
<li><p>window_size: size of the sliding window (ignored if not sliding)</p></li>
</ul>
</p></li>
<li><p><strong>options</strong> (<em>dict {'sliding':</em><em> (</em><em>bool</em><em>)</em><em>, </em><em>'step_size':</em><em> (</em><em>int</em><em>)</em><em>, </em><em>'kernel_name':</em><em> (</em><em>string</em><em>)</em><em>}</em><em>, </em><em>optional</em>) – <p>a dictionary consisting of 3 key value pairs:</p>
<ul>
<li><p>’sliding’: whether to use sliding approach</p></li>
<li><p>’step_size’: step size for sliding</p></li>
<li><p>’kernel_name’: kernel to use for weighting and smoothing windows (‘gaussian’ or ‘friedrichs’)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple consisting of:</p>
<ul class="simple">
<li><p>x_hat: estimated (smoothed) x</p></li>
<li><p>dxdt_hat: estimated derivative of x</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple -&gt; (np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynumdiff.linear_model._linear_model.lineardiff">
<code class="sig-prename descclassname"><span class="pre">pynumdiff.linear_model._linear_model.</span></code><code class="sig-name descname"><span class="pre">lineardiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pynumdiff.linear_model._linear_model.lineardiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Slide a smoothing derivative function across a time series with specified window size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em><em> (</em><em>float</em><em>)</em>) – array of time series to differentiate</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step size</p></li>
<li><p><strong>params</strong> (<em>list</em><em> (</em><em>int</em><em>, </em><em>float</em><em>, </em><em>int</em><em>)</em>) – <p>a list of 3 elements:</p>
<ul>
<li><p>N: order of the polynomial</p></li>
<li><p>gamma: regularization term</p></li>
<li><p>window_size: size of the sliding window (ignored if not sliding)</p></li>
</ul>
</p></li>
<li><p><strong>options</strong> (<em>dict {'sliding':</em><em> (</em><em>bool</em><em>)</em><em>, </em><em>'step_size':</em><em> (</em><em>int</em><em>)</em><em>, </em><em>'kernel_name':</em><em> (</em><em>string</em><em>)</em><em>}</em><em>, </em><em>optional</em>) – <p>a dictionary consisting of 3 key value pairs:</p>
<ul>
<li><p>’sliding’: whether to use sliding approach</p></li>
<li><p>’step_size’: step size for sliding</p></li>
<li><p>’kernel_name’: kernel to use for weighting and smoothing windows (‘gaussian’ or ‘friedrichs’)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple consisting of:</p>
<ul class="simple">
<li><p>x_hat: estimated (smoothed) x</p></li>
<li><p>dxdt_hat: estimated derivative of x</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple -&gt; (np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynumdiff.linear_model._linear_model.polydiff">
<code class="sig-prename descclassname"><span class="pre">pynumdiff.linear_model._linear_model.</span></code><code class="sig-name descname"><span class="pre">polydiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pynumdiff.linear_model._linear_model.polydiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit polynomials to the time series, and differentiate the polynomials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em><em> (</em><em>float</em><em>)</em>) – array of time series to differentiate</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step size</p></li>
<li><p><strong>params</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – <p>a list of 2 elements:</p>
<ul>
<li><p>N: order of the polynomial</p></li>
<li><p>window_size: size of the sliding window (ignored if not sliding)</p></li>
</ul>
</p></li>
<li><p><strong>options</strong> (<em>dict {'sliding':</em><em> (</em><em>bool</em><em>)</em><em>, </em><em>'step_size':</em><em> (</em><em>int</em><em>)</em><em>, </em><em>'kernel_name':</em><em> (</em><em>string</em><em>)</em><em>}</em><em>, </em><em>optional</em>) – <p>a dictionary consisting of 3 key value pairs:</p>
<ul>
<li><p>’sliding’: whether to use sliding approach</p></li>
<li><p>’step_size’: step size for sliding</p></li>
<li><p>’kernel_name’: kernel to use for weighting and smoothing windows (‘gaussian’ or ‘friedrichs’)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple consisting of:</p>
<ul class="simple">
<li><p>x_hat: estimated (smoothed) x</p></li>
<li><p>dxdt_hat: estimated derivative of x</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple -&gt; (np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynumdiff.linear_model._linear_model.savgoldiff">
<code class="sig-prename descclassname"><span class="pre">pynumdiff.linear_model._linear_model.</span></code><code class="sig-name descname"><span class="pre">savgoldiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pynumdiff.linear_model._linear_model.savgoldiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the Savitzky-Golay to smooth the data and calculate the first derivative. It wses scipy.signal.savgol_filter. The Savitzky-Golay is very similar to the sliding polynomial fit, but slightly noisier, and much faster</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em><em> (</em><em>float</em><em>)</em>) – array of time series to differentiate</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step size</p></li>
<li><p><strong>params</strong> (<em>list</em><em> (</em><em>int</em><em>)</em>) – <p>a list of three elements:</p>
<ul>
<li><p>N: order of the polynomial</p></li>
<li><p>window_size: size of the sliding window, must be odd (if not, 1 is added)</p></li>
<li><p>smoothing_win: size of the window used for gaussian smoothing, a good default is window_size, but smaller for high frequnecy data</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple consisting of:</p>
<ul class="simple">
<li><p>x_hat: estimated (smoothed) x</p></li>
<li><p>dxdt_hat: estimated derivative of x</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple -&gt; (np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynumdiff.linear_model._linear_model.spectraldiff">
<code class="sig-prename descclassname"><span class="pre">pynumdiff.linear_model._linear_model.</span></code><code class="sig-name descname"><span class="pre">spectraldiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pynumdiff.linear_model._linear_model.spectraldiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a derivative in the fourier domain, with high frequency attentuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em><em> (</em><em>float</em><em>)</em>) – array of time series to differentiate</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – time step size</p></li>
<li><p><strong>params</strong> (<em>list</em><em> (</em><em>float</em><em>) or </em><em>float</em>) – the high frequency cut off</p></li>
<li><p><strong>options</strong> (<em>dict {'even_extension':</em><em> (</em><em>bool</em><em>)</em><em>, </em><em>'pad_to_zero_dxdt':</em><em> (</em><em>bool</em><em>)</em><em>}</em><em>, </em><em>optional</em>) – <p>a dictionary consisting of 2 key value pairs:</p>
<ul>
<li><p>’even_extension’: if True, extend the time series with an even extension so signal starts and ends at the same value.</p></li>
<li><p>’pad_to_zero_dxdt’: if True, extend the time series with extensions that smoothly force the derivative to zero. This allows the spectral derivative to fit data which does not start and end with derivatives equal to zero.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple consisting of:</p>
<ul class="simple">
<li><p>x_hat: estimated (smoothed) x</p></li>
<li><p>dxdt_hat: estimated derivative of x</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple -&gt; (np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../smooth_finite_difference.html" class="btn btn-neutral float-right" title="smooth_finite_difference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../linear_model.html" class="btn btn-neutral float-left" title="linear_model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Floris van Breugel, Yuying Liu.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>